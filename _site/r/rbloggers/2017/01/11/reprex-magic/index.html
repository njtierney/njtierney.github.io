<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Magic reprex &middot; Nicholas Tierney
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/favicon-114.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-146052-15', 'getpoole.com');
    ga('send', 'pageview');
  </script>
</head>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69408097-1', 'auto');
  ga('send', 'pageview');

</script>

  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Statistics and R Enthusiast</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Blog</a>

    

    
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/Bio/">Bio</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/Publications/">Publications</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/Resources/">Resources</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/cv/">Curriculum Vitae</a>
        
      
    
      
    
      
        
      
    
    <li class="sidebar-nav-item"><a href="https://github.com/njtierney/tierneyn.github.io">GitHub</a></li>

  </nav>

  <div class="sidebar-item">
    <p>
      &copy; Nicholas Tierney, 2017. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Nicholas Tierney</a>
            <small>Original witty remark</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<div class="post">
  <h1 class="post-title">Magic reprex</h1>
  <span class="post-date">
  <!-- add in images -->
   <img class="img-icon" src="/assets/iconmonstr-calendar-8-icon.svg"></img>11 Jan 2017
    <img class="img-icon" src="/assets/iconmonstr-tags-4-icon.svg"></img> R   rbloggers  </span>

  <p>Making reproducible examples can be hard.</p>

<p>There’s a lot of things you need to consider. Like, making sure your environment is clean, the right packages are loaded, the code is formatted nicely, and images are the right resolution and dimension.</p>

<p>Getting all of these ducks lined up can sometimes take a couple of minutes, if you have a nice tightly defined problem. Other times, it can take much, much longer. Say for example, if you had a variable loaded in your environment that you forgot how to create, and you didn’t realise it was so important and OH GOD HOW DID I EVEN DO THIS? Ahem.</p>

<p>So, after some sensible swearing and frustration, you might ask yourself something like:</p>

<blockquote>
  <p>Surely there’s an easy, reproducible way to … make reproducible examples?</p>
</blockquote>

<p>Enter the R package <code class="highlighter-rouge">reprex</code> [<a href="https://cran.r-project.org/web/packages/reprex/index.html">CRAN</a>] [<a href="https://github.com/jennybc/reprex">GitHub</a>], by <a href="http://www.github.com/jennybc">Jenny Bryan</a>.</p>

<p>In the fashion of the times right now, I’ll illustrate <code class="highlighter-rouge">reprex</code> with a gif, which shows the following things:</p>

<ol>
  <li>Take your code, copy it to the clipboard.</li>
  <li>Run <code class="highlighter-rouge">reprex</code>, wait a moment for the code to execute.</li>
  <li><code class="highlighter-rouge">reprex</code> creates a html preview of your code.</li>
  <li>A markdown chunk is also copied to the clipboard.</li>
</ol>

<p>
<div style="height: auto">
<img src="/assets/reprex-run.gif" alt="Gif of reprex copying code, running reprex, and demonstrating the html preview of the code text" style="width: 100%;max-height: 100%" />
</div>
</p>

<p>This means you can copy this to say, GitHub (<code class="highlighter-rouge">reprex(venue = "gh")</code>) (the default) to help you file an issue:</p>

<p>
<div style="height: auto">
<img src="/assets/reprex-github.gif" alt="Gif of reprex copying code, running reprex, and demonstrating the html preview of the code text" style="width: 100%;max-height: 100%" />
</div>
</p>

<p>There is also an option for Stack Overflow(<code class="highlighter-rouge">reprex(venue = "so")</code>.</p>

<p>How does this work? <code class="highlighter-rouge">reprex</code> takes the section of copied code and then runs <code class="highlighter-rouge">rmarkdown::render</code> on it, which starts a fresh environment, and runs the code.
This means that <code class="highlighter-rouge">reprex</code> will fail hard and fail early if your examples aren’t reproducible. If you don’t have the correct library loaded, it will show the error messages.</p>

<p>
<div style="height: auto">
<img src="/assets/reprex-fail-1.gif" alt="Gif of reprex copying code, running reprex, and demonstrating the html preview of the code text" style="width: 100%;max-height: 100%" />
</div>
</p>

<p>But then when you fix that, by adding library calls to <a href="https://github.com/njtierney/visdat"><code class="highlighter-rouge">visdat</code></a>, <a href="https://github.com/tidyverse/ggplot2"><code class="highlighter-rouge">ggplot2</code></a> and <a href="https://github.com/njtierney/naniar"><code class="highlighter-rouge">naniar</code></a>, and you get what you want:</p>

<p>
<div style="height: auto">
<img src="/assets/reprex-success-1.gif" alt="Gif of reprex copying code, running reprex, and demonstrating the html preview of the code text using visdat, naniar, and ggplot2 packages" style="width: 100%;max-height: 100%" />
</div>
</p>

<p>So you know that when you run <code class="highlighter-rouge">reprex</code>, and it gives you a reproducible example, it will work!</p>

<p>Also worth mentioning is that rather magically, <code class="highlighter-rouge">reprex</code> also handles images. I didn’t even notice this at first. It was just one of those things where “it just works”. <code class="highlighter-rouge">reprex</code> handles this by uploading them to imgur using the <code class="highlighter-rouge">knitr::imgur_upload</code> function, which creates markdown links to the images.</p>

<p>so</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">

</span><span class="c1"># run a lm
</span><span class="w">
</span><span class="n">lm_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">)</span><span class="w">

</span><span class="c1"># use broom to clean it up
</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">broom</span><span class="p">)</span><span class="w">

</span><span class="n">lm_augmented</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">augment</span><span class="p">(</span><span class="n">lm_fit</span><span class="p">)</span><span class="w">

</span><span class="n">head</span><span class="p">(</span><span class="n">lm_augmented</span><span class="p">)</span><span class="w">

</span><span class="c1"># Explore the fit of the model
</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm_augmented</span><span class="p">,</span><span class="w">
   </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.fitted</span><span class="p">,</span><span class="w">
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> 

</span></code></pre>
</div>

<p>gets turned into</p>

<div class="highlighter-rouge"><pre class="highlight"><code>library(tidyverse)
#&gt; Loading tidyverse: ggplot2
#&gt; Loading tidyverse: tibble
#&gt; Loading tidyverse: tidyr
#&gt; Loading tidyverse: readr
#&gt; Loading tidyverse: purrr
#&gt; Loading tidyverse: dplyr
#&gt; Conflicts with tidy packages ----------------------------------------------
#&gt; filter(): dplyr, stats
#&gt; lag():    dplyr, stats

# run a lm

lm_fit &lt;- lm(Sepal.Length ~ . , data = iris)

# use broom to clean it up

library(broom)

lm_augmented &lt;- augment(lm_fit)

head(lm_augmented)
#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species  .fitted
#&gt; 1          5.1         3.5          1.4         0.2  setosa 5.004788
#&gt; 2          4.9         3.0          1.4         0.2  setosa 4.756844
#&gt; 3          4.7         3.2          1.3         0.2  setosa 4.773097
#&gt; 4          4.6         3.1          1.5         0.2  setosa 4.889357
#&gt; 5          5.0         3.6          1.4         0.2  setosa 5.054377
#&gt; 6          5.4         3.9          1.7         0.4  setosa 5.388886
#&gt;      .se.fit      .resid       .hat    .sigma      .cooksd  .std.resid
#&gt; 1 0.04479188  0.09521198 0.02131150 0.3077918 3.570856e-04  0.31367294
#&gt; 2 0.05514933  0.14315645 0.03230694 0.3076565 1.251718e-03  0.47429637
#&gt; 3 0.04690495 -0.07309695 0.02336968 0.3078349 2.317688e-04 -0.24106926
#&gt; 4 0.05135928 -0.28935683 0.02801904 0.3069173 4.396118e-03 -0.95656076
#&gt; 5 0.04736842 -0.05437691 0.02383379 0.3078627 1.309299e-04 -0.17937436
#&gt; 6 0.05592364  0.01111427 0.03322050 0.3078956 7.772793e-06  0.03684044

# Explore the fit of the model, looking 

ggplot(data = lm_augmented,
       aes(x = .fitted,
           y = Sepal.Length)) + 
  geom_point() 

`![](http://i.imgur.com/h72ZEKG.png)`
</code></pre>
</div>

<p>You can even show the results of the <code class="highlighter-rouge">session_info</code>, for maximum reproducibility, by adding the argument: <code class="highlighter-rouge">reprex::reprex(si = TRUE)</code>, which adds a super nifty drop down box for the session info.</p>

<p>
<div style="height: auto">
<img src="/assets/reprex-si.gif" alt="Gif of reprex copying code, running reprex, showing option SI = TRUE" style="width: 100%;max-height: 100%" />
</div>
</p>

<p>I really like these sorts of small tools in R. Squinting at a distance you might make the mistake of thinking:</p>

<blockquote>
  <p>so what, it does this <strong>one little thing</strong></p>
</blockquote>

<p>But then when you’re actually up close, you realise this means that you don’t have to bend your brain around doing this thing, which can range from mildly annoying to mostly infuriating.</p>

<p>You save time and energy, and can focus more on <strong>doing what you want to do</strong>, and less on <strong>fighting against interruptions</strong>. This comic by <a href="http://heeris.id.au/2013/this-is-why-you-shouldnt-interrupt-a-programmer/">Jason Heeris</a> illustrates this point nicely, I think:</p>

<p>
<div style="height: auto">
<img src="/assets/ProgrammerInterrupted.png" alt="Why you shouldn't interrupt a programmer" style="max-height: 100%" />
</div>
</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">knitr</span><span class="o">::</span><span class="n">include_graphics</span><span class="p">(</span><span class="n">rprojroot</span><span class="o">::</span><span class="n">find_rstudio_root_file</span><span class="p">(</span><span class="s2">"/assets/ProgrammerInterrupted.png"</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<p><img src="//Users/tierneyn/Google Drive/ALL THE THINGS/PhD/code/websites/njtierney.github.io//assets/ProgrammerInterrupted.png" alt="plot of chunk insert-image" /></p>

<p>Once again thank you to Jenny Bryan for making our lives easier. Jenny will be joining the RStudio team this year and I am really looking forward to seeing what she gets up to.</p>

<p>Read more about <code class="highlighter-rouge">reprex</code> on github <a href="http://www.github.com/jennybc/reprex">here</a>.</p>


        <!-- using liquid formatting to define a variable page.comments -->

<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'njtierney'; // required: replace example with your forum shortname
      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    <script src="/public/anchor.min.js"></script>
    <script type="text/javascript">
    anchors.options.placement = 'left';
    anchors.add();
    </script> 

  </body>
</html>
